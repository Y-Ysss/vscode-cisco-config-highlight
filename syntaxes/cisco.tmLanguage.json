{
	"$schema": "https://raw.githubusercontent.com/martinring/tmlanguage/master/tmlanguage.json",
	"name": "Cisco Config",
	"patterns": [
		{
			"include": "#unused"
		},
		{
			"include": "#comment"
		},
		{
			"include": "#interface_type"
		},
		{
			"include": "#description"
		},
		{
			"include": "#interface"
		},
		{
			"include": "#vrf"
		},
		{
			"include": "#qos"
		},
		{
			"include": "#address"
		},
		{
			"include": "#command_hostname"
		},
		{
			"include": "#numeric"
		},
		{
			"include": "#keyword"
		},
		{
			"include": "#param1"
		}
	],
	"repository": {
		"keyword": {
			"patterns": [
				{
					"name": "keyword.other.config-keyword.vlan.cisco",
					"match": "\\s(protocol-vlan|mac-vlan|dot1q-tunnel|dot1Q)(?=\\s|$)"
				},
				{
					"name": "keyword.other.config-keyword.switchport-mode.cisco",
					"match": "\\s(access|trunk|(dynamic\\s(auto|desirable)))(?=\\s|$)"
				},
				{
					"name": "keyword.other.config-keyword.add-remove.cisco",
					"match": "\\s(add|remove|except)(?=\\s|$)"
				},
				{
					"name": "keyword.other.config-keyword.allowed-native.cisco",
					"match": "\\s(allowed|native)(?=\\s|$)"
				},
				{
					"name": "keyword.other.config-keyword.any-all.cisco",
					"match": "\\s(any|all)(?=\\s|$)"
				},
				{
					"name": "keyword.other.config-keyword.permit-deny.cisco",
					"match": "\\s(permit|deny)(?=\\s|$)"
				},
				{
					"name": "keyword.other.config-keyword.status.cisco",
					"match": "\\s(up|down|deleted|administratively(-down)?)(?=\\s|$)"
				},
				{
					"name": "keyword.other.config-keyword.match.cisco",
					"match": "\\s(match-(any|all))(?=\\s|$)"
				},
				{
					"name": "keyword.other.config-keyword.in-out.cisco",
					"match": "\\s(in|out)(?=\\s|$)"
				},
				{
					"name": "keyword.other.config-keyword.input-output.cisco",
					"match": "\\s(input|output)(?=\\s|$)"
				}
			]
		},
		"interface_type": {
			"patterns": [
				{
					"include": "#ethernet"
				},
				{
					"include": "#wireless"
				},
				{
					"include": "#loopback"
				},
				{
					"include": "#port_channel"
				},
				{
					"include": "#tunnel"
				},
				{
					"include": "#vlan"
				},
				{
					"include": "#null"
				},
				{
					"include": "#serial"
				},
				{
					"include": "#cellular"
				}
			],
			"repository": {
				"ethernet": {
					"name": "entity.name.class.interface.ethernet.cisco",
					"match": "\\b(([Ff]ast|([Ff]ive|[Tt]en|[Ff]orty)?[Gg]igabit)?[Ee]thernet|Fa|Gi|Te|Fo)(((\\d+[\\./])*)?\\d+(\\.\\d+)?)?\\b"
				},
				"wireless": {
					"name": "entity.name.class.interface.wireless.cisco",
					"match": "\\b([Dd]ot11[Rr]adio)(([0-1]([\\./]\\d)?(\\.\\d+)?)\\b(\\.\\d+)?)?\\b"
				},
				"loopback": {
					"name": "entity.name.class.interface.loopback.cisco",
					"match": "\\b([Ll]oopback|Lo)(\\d+)?\\b"
				},
				"port_channel": {
					"name": "entity.name.class.interface.portchannel.cisco",
					"match": "\\b([Pp]ort-channel|Po)(12[0-8]|1[0-1][0-9]|[1-9][0-9]|[1-9])?\\b"
				},
				"tunnel": {
					"name": "entity.name.class.interface.tunnel.cisco",
					"match": "\\b([Tt]unnel|Tu)(\\d+)?\\b"
				},
				"vlan": {
					"name": "entity.name.class.interface.vlan.cisco",
					"match": "\\b(VLAN|Vlan|vlan)(409[0-4]|40[0-8][0-9]|[1-3][0-9]{3}|[1-9][0-9]{1,2}|[1-9])?\\b"
				},
				"null": {
					"name": "entity.name.class.interface.null.cisco",
					"match": "\\b([Nn]ull)(\\d+)?\\b"
				},
				"serial": {
					"name": "entity.name.class.interface.serial.cisco",
					"match": "\\b([Ss]erial)(((\\d+[\\./])*)?\\d+(\\.\\d+)?)?\\b"
				},
				"cellular": {
					"name": "entity.name.class.interface.serial.cisco",
					"match": "\\b([Cc]ellular)(((\\d+[\\./])*)?\\d+(\\.\\d+)?)?\\b"
				}
			}
		},
		"numeric": {
			"patterns": [
				{
					"include": "#integer"
				},
				{
					"include": "#hex"
				}
			],
			"repository": {
				"hex": {
					"name": "constant.numeric.hex.cisco",
					"match": "\\b(0x)?[0-9A-F]{2}+?\\b"
				},
				"integer": {
					"name": "constant.numeric.integer.cisco",
					"match": "\\b-?\\d+\\b"
				}
			}
		},
		"comment": {
			"patterns": [
				{
					"name": "comment.line",
					"match": "^\\s*!.*"
				}
			]
		},
		"address": {
			"patterns": [
				{
					"include": "#cidr"
				},
				{
					"include": "#ipv4-full"
				},
				{
					"include": "#ipv6-condensed"
				},
				{
					"include": "#ipv6-full"
				},
				{
					"include": "#mac"
				}
			],
			"repository": {
				"cidr": {
					"name": "keyword.other.ipaddress.ipv4.cidr.cisco",
					"match": "\\b((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])/(\\d|[1-2]\\d|3[0-2])\\b"
				},
				"ipv4-full": {
					"name": "keyword.other.ipaddress.ipv4.full.cisco",
					"match": "\\b((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])\\b"
				},
				"ipv6-condensed": {
					"name": "keyword.other.ipaddress.ipv6.condensed.cisco",
					"match": "\\b(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))\\b"
				},
				"ipv6-full": {
					"name": "keyword.other.ipaddress.ipv6.full.cisco",
					"match": "\\b([0-9a-f]{1,4}:){7}[0-9a-f]{1,4}\\b"
				},
				"mac":{
					"name":"keyword.other.ipaddress.mac.cisco",
					"match":"\\b([a-fA-F0-9]{2}[:.-]?){5}[a-fA-F0-9]{2}\\b"
				}
			}
		},
		"command_hostname": {
			"patterns": [
				{
					"name": "meta.function-call.command_hostname.cisco",
					"match": "^(?!\\s).*\\s*?#"
				},
				{
					"name": "meta.function-call.command_hostname.cisco",
					"match": "^(?!\\s).*\\s*?>"
				}
			]
		},
		"param1": {
			"patterns": [
				{
					"name": "punctuation",
					"match": "(?<=^\\s*?)\\S+"
				}
			]
		},
		"description": {
			"patterns": [
				{
					"match": "(?<=(description|Description:))\\s(.*)$",
					"name": "string.other.description.cisco"
				}
			]
		},
		"vrf": {
			"patterns": [
				{
					"comment": "((?<=vrf\\s)(?!.*forwarding)|(?<=vrf\\sforwarding\\s))\\S+",
					"match": "(vrf)\\s((forwarding|definition)\\s)?(\\S+)",
					"captures": {
						"1": {
							"name": "entity.name.class.vrf.declaration.cisco"
						},
						"2": {
							"name": "entity.other.vrf.forwarding.cisco"
						},
						"3": {
							"name": "entity.other.vrf.definition.cisco"
						},
						"4": {
							"name": "entity.name.tag.vrf.vrf-name.cisco"
						}
					}
				}
			]
		},
		"qos": {
			"patterns": [
				{
					"include": "#class"
				},
				{
					"include": "#service-policy"
				},
				{
					"include": "#policy-map"
				},
				{
					"include": "#class-map"
				},
				{
					"include": "#route-map"
				},
				{
					"include": "#prefix-list"
				},
				{
					"include": "#access-list"
				},
				{
					"include": "#access-group"
				},
				{
					"include": "#object-group"
				}
			],
			"repository": {
				"class": {
					"match": "(?<=class\\s(.*\\s)?)(\\S+)$",
					"name": "entity.name.tag.qos.class.name.cisco"
				},
				"service-policy": {
					"match": "(?<=service-policy\\s(.*\\s)?)(\\S+)$",
					"name": "entity.name.tag.qos.service-policy.name.cisco"
				},
				"policy-map": {
					"match": "(?<=policy-map\\s(.*\\s)?)(\\S+)$",
					"name": "entity.name.tag.qos.policy-map.name.cisco"
				},
				"class-map": {
					"match": "(?<=class-map\\s(.*\\s)?)(\\S+)$",
					"name": "entity.name.tag.qos.class-map.name.cisco"
				},
				"route-map": {
					"match": "(?<=class-map\\s(.*\\s)?)(\\S+)$",
					"name": "entity.name.tag.qos.route-map.name.cisco"
				},
				"prefix-list": {
					"match": "(?<=prefix-list\\s(.*\\s)?)(\\S+)$",
					"name": "entity.name.tag.qos.prefix-list.name.cisco"
				},
				"access-list": {
					"match": "(?<=access-list\\s)((extended|standard)\\s)?(\\S+)\\b",
					"captures":{
						"2": {
							"name": "keyword.other.qos.access-list.type.cisco"
						},
						"3": {
							"name": "entity.name.tag.qos.access-list.name.cisco"
						}
					}
					
				},
				"access-group": {
					"match": "(?<=access-group\\s)((name)\\s)?(\\S+)\\b",
					"captures":{
						"3": {
							"name": "entity.name.tag.qos.access-group.name.cisco"
						}
					}
				},
				"object-group": {
					"match": "(?<=object-group\\s)((service|network)\\s)?(\\S+)\\b",
					"captures":{
						"2": {
							"name": "keyword.other.qos.object-group.type.cisco"
						},
						"3": {
							"name": "entity.name.tag.qos.object-group.name.cisco"
						}
					}
					
				}
			}
		},
		"unused": {
			"patterns": [
				{
					"include": "#unused"
				},
				{
					"include": "#default"
				}
			],
			"repository": {
				"unused": {
					"name": "meta.function-call.command-disable.unused.cisco",
					"match": "^\\s*?no\\s.*"
				},
				"default": {
					"name": "meta.function-call.command-disable.default.cisco",
					"match": "^\\s*?default\\s.*"
				}
			}
		}
	},
	"scopeName": "source.cisco"
}